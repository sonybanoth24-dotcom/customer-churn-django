<!DOCTYPE html>
<html>
<head>
    <title>Customer Churn Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial;
            background: linear-gradient(135deg,#667eea,#764ba2);
            margin:0;
        }

        .topbar {
            position:absolute;
            top:20px;
            right:30px;
            color:white;
        }

        .topbar a {
            color:white;
            text-decoration:none;
            margin-left:10px;
        }

        .container {
            width:500px;
            margin:100px auto;
            background:white;
            padding:30px;
            border-radius:15px;
            text-align:center;
        }

        input {
            width:100%;
            padding:10px;
            margin:10px 0;
        }

        button {
            padding:10px 20px;
            background:#667eea;
            color:white;
            border:none;
            border-radius:6px;
        }

        .result {
            margin-top:15px;
            font-weight:bold;
        }
    </style>
</head>
<body>

<div class="topbar">
    Welcome {{ request.user.username }} |
    <a href="{% url 'logout' %}">Logout</a>
</div>

<div class="container">
    <h2>Customer Churn Prediction</h2>

    <form method="POST">
        {% csrf_token %}
        <input type="number" step="any" name="age" placeholder="Enter Age" required>
        <input type="number" step="any" name="balance" placeholder="Enter Balance" required>
        <button type="submit">Predict</button>
    </form>

    {% if prediction %}
        <div class="result">{{ prediction }}</div>

        <canvas id="myChart"></canvas>

        <script>
            const ctx = document.getElementById('myChart');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Stay %', 'Churn %'],
                    datasets: [{
                        label: 'Prediction Probability',
                        data: [{{ stay_prob }}, {{ churn_prob }}],
                        backgroundColor: ['#4CAF50', '#f44336']
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        </script>
    {% endif %}
</div>

</body>
</html>